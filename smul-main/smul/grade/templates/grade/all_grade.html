{% extends 'main/base.html' %}
{% load static %}

{% block title %}ì „ì²´ì„±ì ì¡°íšŒ{% endblock %}

{% block content %}
<div class="grade-wrapper">

  <!-- ğŸ”¹ ë¡œê·¸ì¸ ì‚¬ìš©ì ì •ë³´ -->
  <div class="student-info">
    <label for="student-id">í•™ë²ˆ / ì„±ëª… <span class="required">*</span></label>
    <input type="text" id="student-id" value="{{ user.username }}" readonly>
    <input type="text" id="student-name" value="{{ user.get_full_name|default:'ì„±ëª…ì—†ìŒ' }}" readonly>
  </div>

  <!-- ğŸ”¹ ì œëª© -->
  <h3 class="grade-title">â–  ì „ì²´ì„±ì ì¡°íšŒ</h3>

  <!-- ğŸ”¹ í•™ê¸°ë³„ ì„±ì  í…Œì´ë¸” -->
  <h4>â–  í•™ê¸°ë³„ ì„±ì </h4>
  <table class="grade-table">
    <thead>
      <tr>
        <th>No</th>
        <th>í•™ë…„ë„</th>
        <th>í•™ê¸°</th>
        <th>ì‹ ì²­í•™ì </th>
        <th>í‰ì ê³„</th>
        <th>í‰ì í‰ê· </th>
        <th>ë°±ë¶„ìœ¨</th>
        <th>ì„ì°¨</th>
      </tr>
    </thead>
    <tbody id="grade-table-body">
      <!-- APIì—ì„œ ë™ì ìœ¼ë¡œ ì‚½ì…ë¨ -->
    </tbody>
  </table>
</div>

<script>
fetch('/api/grade/total/')
  .then(response => response.json())
  .then(data => {
    const tbody = document.getElementById("grade-table-body");
    let no = 1;
    data.grades.forEach(g => {
      const row = `
        <tr>
          <td>${no++}</td>
          <td>${g.year}</td>
          <td>${g.semester}</td>
          <td>${g.total_credit}</td>
          <td>${parseFloat(g.grade_point).toFixed(2)}</td>
          <td>${parseFloat(g.grade_average).toFixed(2)}</td>
          <td>${parseFloat(g.percentile).toFixed(2)}</td>
          <td>${g.rank}</td>
        </tr>`;
      tbody.innerHTML += row;
    });
  });
</script>
{% endblock %}
